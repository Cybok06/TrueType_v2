<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dashboard</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
  <link rel="icon" href="https://res.cloudinary.com/dl2ipzxyk/image/upload/v1751107241/logo_ijmteg.avif" type="image/png">

  <style>
    :root{
      --brand:#0d6efd; --ink:#0b2447; --muted:#6b7a99; --bg:#f5f7fb;
      --card-grad: linear-gradient(135deg, #0d6efd 0%, #5b8df7 100%);
      --card-grad-2: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
      --card-grad-3: linear-gradient(135deg, #fd9644 0%, #f39c12 100%);
      --card-grad-4: linear-gradient(135deg, #c056ff 0%, #845ef7 100%);
    }
    body{ background: var(--bg); }
    .page-title{ color:#0b5ed7; }
    .card-welcome{ border:1px solid rgba(13,110,253,.08); border-radius: .9rem; }

    .kpi{
      position:relative; overflow:hidden; border:0; border-radius:1rem;
      color:#fff; box-shadow:0 10px 24px rgba(13,110,253,.15);
      transition: transform .12s ease, box-shadow .12s ease;
      min-height: 148px;
    }
    .kpi:hover{ transform: translateY(-2px); box-shadow:0 14px 28px rgba(13,110,253,.22); }
    .kpi .icon{
      position:absolute; right:-10px; top:-10px; opacity:.18; font-size:5rem; pointer-events:none;
    }
    .kpi .value{ font-size:2.2rem; font-weight:800; line-height:1; }
    .kpi .label{ opacity:.9; }
    .kpi a.stretched-link{ color: #fff; text-decoration: none; }

    .focus-card{ border:1px solid rgba(13,110,253,.12); border-radius:.9rem; }
    .focus-card .card-header{ background:#fff; }
    .focus-list .item-title{ font-weight:800; color:#0f172a; }
    .focus-list .item-sub{ color:#6b7a99; }
    .pill{ border-radius:999px; padding:.2rem .55rem; font-size:.75rem; }
    .pill-status{ background:#eef2ff; color:#1e3a8a; }
    .pill-prio-low{ background:#e8faf0; color:#0b8464; }
    .pill-prio-normal{ background:#e8f1ff; color:#0b3c8a; }
    .pill-prio-high{ background:#fff3cd; color:#9a6b00; }
    .pill-prio-urgent{ background:#fde2e2; color:#8a1111; }
    .empty-state{ color:#6b7a99; }
  </style>
</head>
<body>

  {% include 'frontdesk_pages/front_desk_sidebar.html' %}

  <div class="container-fluid py-4">

    <!-- Welcome -->
    <div class="card card-welcome mb-3">
      <div class="card-body d-flex align-items-center justify-content-between flex-wrap gap-2">
        <div>
          <h4 class="page-title mb-1"><i class="bi bi-speedometer2 me-2"></i>Dashboard</h4>
          <div class="text-muted">Welcome, <strong>{{ name }}</strong></div>
        </div>
        <div class="text-muted small">Last updated: {{ now | safe }}</div>
      </div>
    </div>

    <!-- KPIs -->
    <div class="row g-3 mb-3">
      <div class="col-12 col-sm-6 col-xl-3">
        <div class="kpi p-4" style="background: var(--card-grad);">
          <i class="bi bi-people icon"></i>
          <div class="label mb-1">Employees</div>
          <div class="value">{{ kpis.employees }}</div>
          <div class="mt-2 opacity-75">Directory & profiles</div>
          <a class="stretched-link" href="/frontdesk/employees"></a>
        </div>
      </div>

      <div class="col-12 col-sm-6 col-xl-3">
        <div class="kpi p-4" style="background: var(--card-grad-3);">
          <i class="bi bi-check2-square icon"></i>
          <div class="label mb-1">Undone Tasks</div>
          <div class="value">{{ kpis.tasks }}</div>
          <div class="mt-2 opacity-75">To do · In progress · Blocked</div>
          <a class="stretched-link" href="/frontdesk/tasks"></a>
        </div>
      </div>

      <div class="col-12 col-sm-6 col-xl-3">
        <div class="kpi p-4" style="background: var(--card-grad-4);">
          <i class="bi bi-calendar3 icon"></i>
          <div class="label mb-1">Upcoming Meetings</div>
          <div class="value">{{ kpis.meetings }}</div>
          <div class="mt-2 opacity-75">Scheduled in the future</div>
          <a class="stretched-link" href="/frontdesk/meetings"></a>
        </div>
      </div>

      <div class="col-12 col-sm-6 col-xl-3">
        <div class="kpi p-4" style="background: var(--card-grad-2);">
          <i class="bi bi-folder2-open icon"></i>
          <div class="label mb-1">Documents</div>
          <div class="value">{{ kpis.documents }}</div>
          <div class="mt-2 opacity-75">Library & attachments</div>
          <a class="stretched-link" href="/frontdesk/documents"></a>
        </div>
      </div>
    </div>

    <!-- Focus: Tasks + Meetings -->
    <div class="row g-3">
      <div class="col-12 col-xl-6">
        <div class="card focus-card">
          <div class="card-header d-flex align-items-center justify-content-between">
            <strong><i class="bi bi-list-check me-2"></i>Tasks to do</strong>
            <a href="/frontdesk/tasks" class="btn btn-sm btn-outline-primary">View all</a>
          </div>
          <div class="card-body">
            {% if top_tasks and top_tasks|length %}
              <div class="list-group focus-list">
                {% for t in top_tasks %}
                  <a href="/frontdesk/tasks" class="list-group-item list-group-item-action d-flex gap-3 align-items-start">
                    <div class="flex-grow-1">
                      <div class="item-title">{{ t.title }}</div>
                      <div class="item-sub small">
                        {% if t.due_date %}
                          <i class="bi bi-clock"></i> Due {{ t.due_human }}
                        {% else %}
                          No due date
                        {% endif %}
                        · <span class="pill pill-status">{{ t.status.replace('_',' ') }}</span>
                        {% if t.priority == 'low' %}<span class="pill pill-prio-low">Low</span>{% endif %}
                        {% if t.priority == 'normal' %}<span class="pill pill-prio-normal">Normal</span>{% endif %}
                        {% if t.priority == 'high' %}<span class="pill pill-prio-high">High</span>{% endif %}
                        {% if t.priority == 'urgent' %}<span class="pill pill-prio-urgent">Urgent</span>{% endif %}
                      </div>
                    </div>
                    <i class="bi bi-chevron-right text-muted"></i>
                  </a>
                {% endfor %}
              </div>
            {% else %}
              <div class="text-center empty-state py-3">
                <i class="bi bi-emoji-smile fs-3 d-block mb-2"></i>
                Nothing pending — you’re all caught up!
              </div>
            {% endif %}
          </div>
        </div>
      </div>

      <div class="col-12 col-xl-6">
        <div class="card focus-card">
          <div class="card-header d-flex align-items-center justify-content-between">
            <strong><i class="bi bi-calendar-event me-2"></i>Upcoming meetings</strong>
            <a href="/frontdesk/meetings" class="btn btn-sm btn-outline-primary">Open calendar</a>
          </div>
          <div class="card-body">
            {% if next_meetings and next_meetings|length %}
              <div class="list-group focus-list">
                {% for m in next_meetings %}
                  <a href="/frontdesk/meetings" class="list-group-item list-group-item-action d-flex gap-3 align-items-start">
                    <div class="flex-grow-1">
                      <div class="item-title">{{ m.title }}</div>
                      <div class="item-sub small">
                        <i class="bi bi-clock"></i> {{ m.when }}
                        {% if m.location %} · <i class="bi bi-geo-alt"></i> {{ m.location }}{% endif %}
                        {% if m.category %} · <span class="pill pill-status">{{ m.category }}</span>{% endif %}
                      </div>
                    </div>
                    <i class="bi bi-chevron-right text-muted"></i>
                  </a>
                {% endfor %}
              </div>
            {% else %}
              <div class="text-center empty-state py-3">
                <i class="bi bi-calendar-x fs-3 d-block mb-2"></i>
                No upcoming meetings.
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
